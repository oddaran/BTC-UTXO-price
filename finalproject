#import the bitcoin excel values
btcdata <- read.table(file="clipboard", sep = "\t", header=TRUE)
#find descriptive stats
summary(btcdata)
#find variance and std deviation
var(btcdata)
sd(btcdata)
#convert factor to date data
as.Date(btcdata$endweek, format = "%m/%d/%y")

# Visualize time series and plots
library(ggplot2)
# Begin by collapsing two series with tidyr
library(tidyr)
library(dplyr)

# Single line ts plot utxo count
p1 <- ggplot(btcdata, aes(x=endweek, y=utxo_average)) +
  geom_line(color = "#33CC33", size = 2) + 
  xlab("Date")
p1 <- p1 + scale_x_date(date_labels = "%b-%y", date_breaks = "6 months")
p1 <- p1 + labs(title = "BTC Unspent Transaction Output",
  caption = "Source: blockchain.info")
print(p1)
# Single line ts plot price
p2 <- ggplot(btcdata, aes(x=endweek, y=price_usdavg)) +
  geom_line(color = "#0066FF", size = 2) + 
  xlab("Date")
p2 <- p2 + scale_x_date(date_labels = "%b-%y", date_breaks = "6 months")
p2 <- p2 + labs(title = "BTC Price (USD)",
  caption = "Source: blockchain.info")
print(p2)

# Multiple ts plot change aesthetics and labels
chart <- btcdata %>%
  select(endweek, utxo_average, price_usdavg) %>%
  gather(key = "variable", value = "value", -endweek)
head(chart, 3)
g <- ggplot(chart, aes(x = endweek, y = value)) + 
  geom_line(aes(color = variable), size = 1) +
  scale_color_manual(values = c("#33CC33", "#0066FF")) +
  theme_minimal()
g <- g + labs(title = "BTC Unspent Transaction Output", 
  caption = "Source: blockchain.info")

# Correlate the ts plots by determining linearity and nml dist
library("ggpubr")
# utxo
ggqqplot(btcdata$utxo_average, ylab = "UTXO")
# price
ggqqplot(btcdata$price_usdavg, ylab = "Price USD")

# Use Spearman rank correlation coefficient
rank <-cor.test(btcdata$utxo_average, btcdata$price_usdavg, method = "spearman")
rank
ggscatter(btcdata, x = "utxo_average", y = "price_usdavg", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "spearman",
          xlab = "Unspent transaction output", ylab = "Price in USD")
# End of R script
